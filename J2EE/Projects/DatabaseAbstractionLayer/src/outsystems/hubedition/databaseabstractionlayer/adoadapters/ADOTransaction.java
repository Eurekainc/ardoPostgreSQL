/* 
 This source code (the "Generated Software") is generated by the OutSystems Platform 
 and is licensed by OutSystems (http://www.outsystems.com) to You solely for testing and evaluation 
 purposes, unless You and OutSystems have executed a specific agreement covering the use terms and 
 conditions of the Generated Software, in which case such agreement shall apply. 
*/

package outsystems.hubedition.databaseabstractionlayer.adoadapters;

import java.sql.Connection;
import java.sql.SQLException;

public class ADOTransaction {
	private Connection conn;
	
    public ADOTransaction(Connection conn, int isolationLevel) throws SQLException {
        this(conn);
		conn.setTransactionIsolation(isolationLevel);
	}
	
	public ADOTransaction(Connection conn) throws SQLException {
		this.conn = conn;
		
		conn.setAutoCommit(false);
	}	
	
	public Connection getConnection() {
		return conn;
	}
	
	public void commit() throws SQLException {
		conn.commit();
	}
	
	public void rollback() throws SQLException {
		conn.rollback();
	}
	
	public boolean Equals(ADOTransaction other){
		return conn.equals(other.getConnection());
	}
	
	public void returnConnectionToPool(){
		close();
		conn = null;
	}
	
	public void dispose(){
		close();
		conn = null;
	}
	
	public void close() {
		try {
			if( conn!= null && !conn.isClosed()) {
			    ConnectionUtils.closeConnection(conn);
			}
		} catch ( Exception e) {
		}
	}
}
